load("@rules_java//java:java_library.bzl", "java_library")

package(
    default_applicable_licenses = ["//:license"],
    default_visibility = ["//third_party/java/cel/legacy:__pkg__"],
)

java_library(
    name = "async",
    srcs = [
        "AsyncCanonicalResolver.java",
        "AsyncContext.java",
        "AsyncDispatcher.java",
        "AsyncDispatcherBase.java",
        "AsyncGlobalResolver.java",
        "AsyncInterpretable.java",
        "AsyncInterpretableOrConstant.java",
        "AsyncInterpreter.java",
        "Canonicalization.java",
        "CompiledExpression.java",
        "DefaultAsyncContext.java",
        "DefaultAsyncDispatcher.java",
        "DynamicEnv.java",
        "Effect.java",
        "EvaluationHelpers.java",
        "Evaluator.java",
        "ExecutableExpression.java",
        "FunctionRegistrar.java",
        "FunctionResolver.java",
        "FuturesInterpreter.java",
        "GlobalContext.java",
        "IdentifiedCompiledExpression.java",
        "MessageProcessor.java",
        "MessageProcessorAdapter.java",
        "ProtoFieldAssignment.java",
        "ResolverAdapter.java",
        "StackOffsetFinder.java",
        "StandardConstructs.java",
        "StandardTypeResolver.java",
        "TypeDirectedMessageProcessor.java",
        "TypeResolver.java",
    ],
    tags = [
        "alt_dep=//third_party/java/cel/legacy:async_runtime",
        "avoid_dep",
    ],
    deps = [
        "//:auto_value",
        "//checker:checker_legacy_environment",
        "//common:error_codes",
        "//common:features",
        "//common:options",
        "//common:proto_ast",
        "//common:runtime_exception",
        "//common/annotations",
        "//common/types",
        "//common/types:type_providers",
        "//java/com/google/common/context",
        "//java/com/google/protobuf/contrib:util",
        "//java/com/google/protobuf/contrib/descriptor/pool",
        "//runtime:interpreter",
        "//runtime:runtime_helper",
        "//third_party/java/jsr305_annotations",
        "@cel_spec//proto/cel/expr:expr_java_proto",
        "@maven//:com_google_guava_guava",
        "@maven//:com_google_protobuf_protobuf_java",
        "@maven//:com_google_re2j_re2j",
    ],
)

java_library(
    name = "dummy_async_context",
    testonly = 1,
    srcs = ["DummyAsyncContext.java"],
    tags = [
        "alt_dep=//third_party/java/cel/legacy:dummy_async_context",
        "avoid_dep",
    ],
    deps = [
        ":async",
        "@maven//:com_google_guava_guava",
    ],
)
